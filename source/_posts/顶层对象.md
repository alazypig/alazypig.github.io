---
title: 顶层对象
date: 2018-08-10 19:33:03
tags:
- '学习'
- '整理'
categories:
- 'ECMAScript'
---
### ES6中，为了保持兼容性，var和function声明的全局变量依旧是顶层对象的属性
{% codeblock lang:javascript %}
var a = 1;  //如果在Node的REPL环境，可以写成global.a或者this.a
window.a;   //1
let b = 1;
window.b;   //undefined
{% endcodeblock %}
### global对象
* 在浏览器对象中，顶层对象是window，但Node和Web Worker没有window。
* 在浏览器和Web Worker中，self也指向顶层对象，但Node没有self。
* 在Node中，顶层对象是global，但其他环境都不支持。

以下为两种勉强可以取到顶层对象的方法：
{% codeblock lang:javascript %}
//方法一
(typeof window !== 'undefined' ? window : (
    typeof process === 'object' && typeof require === 'function' && typeof global === 'object') ? global : this
);
//方法二
var getGlobal = function () {
    if (typeof self !== 'undefined') { return self; }
    if (typeof window !== 'undefined') { return window; }
    if (typeof global !== 'undefined') { return global; }
    throw new Error('unalbe to locate global object');
}
{% endcodeblock %}